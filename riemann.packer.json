{
  "builders": [
    {
      "type": "amazon-ebs",
      "region": "eu-central-1",
      "source_ami": "ami-1ac73275",
      "instance_type": "t2.small",
      "ssh_username": "ubuntu",
      "ssh_timeout": "15m",
      "ami_name": "riemann-{{isotime | clean_ami_name}}",
      "iam_instance_profile": "packer"
    }
  ],
  "provisioners": [
    {
        "type" : "shell",
        "inline": "sudo apt-key update && sudo apt-get update && sudo apt-get upgrade -y && sudo apt-get install -y wget build-essential git curl openjdk-7-jre vim-nox"
    },
    {
        "type" : "shell",
        "inline": "echo alias vi=vim >> ~/.bashrc"
    },
    {
        "type" : "shell",
        "inline": "wget https://aphyr.com/riemann/riemann-0.2.11.tar.bz2 && tar xvfj riemann-0.2.11.tar.bz2"
    },
    {
        "type" : "shell",
        "inline": "git clone https://github.com/bergundy/riemann-workshop"
    },
    {
        "type" : "shell",
        "inline": "sudo wget -O /usr/local/bin/lein https://raw.githubusercontent.com/technomancy/leiningen/stable/bin/lein && chmod a+x /usr/local/bin/lein && lein"
    }
  ]
}
